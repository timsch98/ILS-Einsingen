<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Statusmeldung - Fahrzeug</title>
    <link rel="stylesheet" href="../style/status.css">
</head>
<body>

    <div class="container">
        <h1>üöí Fahrzeug-Statusmeldung</h1>

        <div class="section">
            <label for="fahrzeugSelect">Fahrzeug ausw√§hlen:</label>
            <select id="fahrzeugSelect">
                <option value="" disabled selected>Bitte Fahrzeug w√§hlen</option>
            </select>
        </div>

        <div id="einsatzInfo" class="section hidden">
            <h2>üö® Aktueller Einsatz</h2>
            <p id="einsatzText">Kein Einsatz zugewiesen</p>
        </div>

        <div id="statusButtons" class="section hidden">
            <h2>Status setzen</h2>
            <div class="status-buttons">
                <button class="status-btn status-1" data-status="1">1Ô∏è Einsatzbereit √ºber Funk</button>
                <button class="status-btn status-2" data-status="2">2Ô∏è Auf Wache bereit</button>
                <button class="status-btn status-3" data-status="3">3Ô∏è Auftrag √ºbernommen</button>
                <button class="status-btn status-4" data-status="4">4Ô∏è Am Einsatzort</button>
                <button class="status-btn status-5" data-status="5">5Ô∏è Sprechwunsch</button>
                <button class="status-btn status-6" data-status="6">6Ô∏è Nicht einsatzbereit</button>
            </div>
        </div>

        <!-- Button zum √ñffnen der Karte und Navigieren zum Einsatzort -->
        <div class="navigate-btn-container">
            <button id="navigateBtn" class="navigate-btn">üó∫Ô∏è Zum Einsatzort navigieren</button>
        </div>
    </div>

    <script src="../script/status.js"></script>

    <!-- JavaScript zum Navigieren zur Karte basierend auf dem aktuellen Standort -->
    <script>
        // Funktion zur Verwendung der Geolocation API
        function getCurrentLocationAndNavigate() {
            if (navigator.geolocation) {
                // Aktuellen Standort des Nutzers abrufen
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;

                    const einsatzText = document.getElementById("einsatzText").textContent;
                    const einsatzDetails = einsatzText.split(" ‚Äì ");
                    if (einsatzDetails.length > 1) {
                        const [beschreibung, strasse, hausnummer, ort] = einsatzDetails;
                        const address = `${strasse} ${hausnummer}, ${ort}`;

                        // Google Maps URL mit den Koordinaten und der Adresse
                        const googleMapsUrl = `https://www.google.com/maps/dir/${lat},${lon}/${encodeURIComponent(address)}`;
                        
                        // Google Maps im neuen Tab √∂ffnen, der die Navigation startet
                        window.open(googleMapsUrl, "_blank");
                    } else {
                        alert("Kein Einsatzort verf√ºgbar.");
                    }
                }, (error) => {
                    alert("Standort konnte nicht ermittelt werden.");
                });
            } else {
                alert("Geolocation wird in diesem Browser nicht unterst√ºtzt.");
            }
        }

        // Event Listener f√ºr den "Zum Einsatzort navigieren"-Button
        document.getElementById("navigateBtn").addEventListener("click", getCurrentLocationAndNavigate);
    </script>
</body>
</html>
